// ==UserScript==
// @name         B 站自动切换深浅主题
// @namespace    https://github.com/SIXiaolong1117/Rules
// @version      0.2
// @description  根据系统颜色模式自动切换网页 B 站的浅色/深色模式
// @license      MIT
// @icon         https://www.bilibili.com/favicon.ico
// @author       SI Xiaolong
// @match        https://*.bilibili.com/*
// @grant        none
// ==/UserScript==

(function() {
    'use strict';

    // 深色模式CSS变量
    const darkCSS = `
    :root {
        --Ga0: #101011;
        --Ga0_s: #1E2022;
        --Ga0_t: #1E2022;
        --Ga1: #0A0B0C;
        --Ga1_s: #232527;
        --Ga1_t: #232527;
        --Ga1_e: #232527;
        --Ga2: #2F3134;
        --Ga2_t: #2F3134;
        --Ga3: #46494D;
        --Ga3_t: #46494D;
        --Ga4: #5E6267;
        --Ga4_t: #5E6267;
        --Ga5: #757A81;
        --Ga5_t: #757A81;
        --Ga6: #8B9097;
        --Ga6_t: #8B9097;
        --Ga7: #A2A7AE;
        --Ga7_t: #A2A7AE;
        --Ga8: #B9BDC2;
        --Ga8_t: #B9BDC2;
        --Ga9: #D0D3D7;
        --Ga9_t: #D0D3D7;
        --Ga10: #E7E9EB;
        --Ga10_t: #E7E9EB;
        --Ga11: #242628;
        --Ga12: #1F2022;
        --Ga12_s: #2B2C2F;
        --Ga13: #1A1B1D;
        --Ga13_s: #2F3134;
        --Wh0: #17181A;
        --Wh0_s: #2F3134;
        --Wh0_t: #17181A;
        --Ba0: #000000;
        --Ba0_s: #FFFFFF;
        --Ba0_t: #000000;
        --Pi0: #26161C;
        --Pi1: #2F1A22;
        --Pi2: #472030;
        --Pi3: #76304B;
        --Pi4: #A73E65;
        --Pi5: #D44E7D;
        --Pi5_t: #D44E7D;
        --Pi6: #DC6D94;
        --Pi7: #E38CAA;
        --Pi8: #EBABC1;
        --Pi9: #F2CAD8;
        --Pi10: #FAE9EF;
        --Ma0: #261525;
        --Ma1: #2E182D;
        --Ma2: #461C43;
        --Ma3: #72296C;
        --Ma4: #A13396;
        --Ma5: #CB41BB;
        --Ma6: #D462C7;
        --Ma7: #DD83D3;
        --Ma8: #E6A4DE;
        --Ma9: #EFC5EA;
        --Ma10: #F8E6F6;
        --Re0: #261314;
        --Re1: #2E1617;
        --Re2: #471A1C;
        --Re3: #742728;
        --Re4: #A63131;
        --Re5: #D1403E;
        --Re6: #D9615F;
        --Re7: #E18281;
        --Re8: #E9A3A2;
        --Re9: #F1C5C4;
        --Re10: #F9E5E5;
        --Or0: #28180F;
        --Or1: #301B10;
        --Or2: #4A230E;
        --Or3: #783610;
        --Or4: #A9490D;
        --Or5: #D66011;
        --Or6: #DD7C3A;
        --Or7: #E49764;
        --Or8: #EBB38D;
        --Or9: #F2CEB6;
        --Or10: #FAEADF;
        --Ye0: #2A1E0F;
        --Ye1: #342410;
        --Ye2: #4D300B;
        --Ye3: #7C4C08;
        --Ye4: #AD6800;
        --Ye5: #DB8700;
        --Ye6: #E19C2C;
        --Ye7: #E7B158;
        --Ye8: #EEC584;
        --Ye9: #F4DAB1;
        --Ye10: #FAEFDD;
        --Ly0: #2A2310;
        --Ly1: #332A11;
        --Ly2: #49390C;
        --Ly3: #745909;
        --Ly4: #A27C00;
        --Ly5: #CCA000;
        --Ly6: #D5B02C;
        --Ly7: #DEC158;
        --Ly8: #E7D184;
        --Ly9: #EFE2B1;
        --Ly10: #F8F2DD;
        --Lg0: #19220F;
        --Lg1: #1E2911;
        --Lg2: #273C0E;
        --Lg3: #3C600F;
        --Lg4: #50840B;
        --Lg5: #67A70E;
        --Lg6: #81B638;
        --Lg7: #9CC562;
        --Lg8: #B6D58B;
        --Lg9: #D0E4B5;
        --Lg10: #EBF3DF;
        --Gr0: #102017;
        --Gr1: #11271B;
        --Gr2: #123923;
        --Gr3: #175C34;
        --Gr4: #198042;
        --Gr5: #1FA251;
        --Gr6: #46B26F;
        --Gr7: #6DC28D;
        --Gr8: #93D2AB;
        --Gr9: #BAE2C9;
        --Gr10: #E1F3E8;
        --Cy0: #0C1F20;
        --Cy1: #0D2627;
        --Cy2: #093739;
        --Cy3: #085B5C;
        --Cy4: #028080;
        --Cy5: #03A29F;
        --Cy6: #2FB2B0;
        --Cy7: #5AC2C0;
        --Cy8: #86D2D1;
        --Cy9: #B2E2E1;
        --Cy10: #DDF3F3;
        --Lb0: #0A1B23;
        --Lb1: #0B202A;
        --Lb2: #082D40;
        --Lb3: #064A69;
        --Lb4: #006996;
        --Lb5: #0087BD;
        --Lb6: #2C9CC8;
        --Lb7: #58B1D4;
        --Lb8: #84C5DF;
        --Lb9: #B1DBEB;
        --Lb10: #DDEFF6;
        --Bl0: #151826;
        --Bl1: #181C2F;
        --Bl2: #1F2748;
        --Bl3: #2E3C76;
        --Bl4: #3B53A8;
        --Bl5: #4B6BD4;
        --Bl6: #6A85DB;
        --Bl7: #899EE3;
        --Bl8: #A9B8EA;
        --Bl9: #C8D2F2;
        --Bl10: #E7EBF9;
        --Pu0: #1D1628;
        --Pu1: #221A31;
        --Pu2: #31214C;
        --Pu3: #4E317D;
        --Pu4: #6D3FB1;
        --Pu5: #8C50E0;
        --Pu6: #A06EE5;
        --Pu7: #B48DEB;
        --Pu8: #C8ABF0;
        --Pu9: #DBC9F5;
        --Pu10: #F0E8FB;
        --Br0: #211D1B;
        --Br1: #282320;
        --Br2: #382F2A;
        --Br3: #59483F;
        --Br4: #7A6154;
        --Br5: #9A7C6A;
        --Br6: #AC9384;
        --Br7: #BDA99E;
        --Br8: #CEBFB7;
        --Br9: #E0D7D1;
        --Br10: #F2EEEB;
        --Si0: #212325;
        --Si1: #27292C;
        --Si2: #36393F;
        --Si3: #535962;
        --Si4: #6F7987;
        --Si5: #8C99AA;
        --Si6: #A0ABB9;
        --Si7: #B4BCC7;
        --Si8: #C8CED6;
        --Si9: #DCE0E5;
        --Si10: #F0F2F4;
        --Ga0_rgb: 16,16,17;
        --Ga0_s_rgb: 30,32,34;
        --Ga0_t_rgb: 30,32,34;
        --Ga1_rgb: 10,11,12;
        --Ga1_s_rgb: 35,37,39;
        --Ga1_t_rgb: 35,37,39;
        --Ga1_e_rgb: 35,37,39;
        --Ga2_rgb: 47,49,52;
        --Ga2_t_rgb: 47,49,52;
        --Ga3_rgb: 70,73,77;
        --Ga3_t_rgb: 70,73,77;
        --Ga4_rgb: 94,98,103;
        --Ga4_t_rgb: 94,98,103;
        --Ga5_rgb: 117,122,129;
        --Ga5_t_rgb: 117,122,129;
        --Ga6_rgb: 139,144,151;
        --Ga6_t_rgb: 139,144,151;
        --Ga7_rgb: 162,167,174;
        --Ga7_t_rgb: 162,167,174;
        --Ga8_rgb: 185,189,194;
        --Ga8_t_rgb: 185,189,194;
        --Ga9_rgb: 208,211,215;
        --Ga9_t_rgb: 208,211,215;
        --Ga10_rgb: 231,233,235;
        --Ga10_t_rgb: 231,233,235;
        --Ga11_rgb: 36,38,40;
        --Ga12_rgb: 31,32,34;
        --Ga12_s_rgb: 43,44,47;
        --Ga13_rgb: 26,27,29;
        --Ga13_s_rgb: 47,49,52;
        --Wh0_rgb: 23,24,26;
        --Wh0_s_rgb: 47,49,52;
        --Wh0_t_rgb: 23,24,26;
        --Ba0_rgb: 0,0,0;
        --Ba0_s_rgb: 255,255,255;
        --Ba0_t_rgb: 0,0,0;
        --Pi0_rgb: 38,22,28;
        --Pi1_rgb: 47,26,34;
        --Pi2_rgb: 71,32,48;
        --Pi3_rgb: 118,48,75;
        --Pi4_rgb: 167,62,101;
        --Pi5_rgb: 212,78,125;
        --Pi5_t_rgb: 212,78,125;
        --Pi6_rgb: 220,109,148;
        --Pi7_rgb: 227,140,170;
        --Pi8_rgb: 235,171,193;
        --Pi9_rgb: 242,202,216;
        --Pi10_rgb: 250,233,239;
        --Ma0_rgb: 38,21,37;
        --Ma1_rgb: 46,24,45;
        --Ma2_rgb: 70,28,67;
        --Ma3_rgb: 114,41,108;
        --Ma4_rgb: 161,51,150;
        --Ma5_rgb: 203,65,187;
        --Ma6_rgb: 212,98,199;
        --Ma7_rgb: 221,131,211;
        --Ma8_rgb: 230,164,222;
        --Ma9_rgb: 239,197,234;
        --Ma10_rgb: 248,230,246;
        --Re0_rgb: 38,19,20;
        --Re1_rgb: 46,22,23;
        --Re2_rgb: 71,26,28;
        --Re3_rgb: 116,39,40;
        --Re4_rgb: 166,49,49;
        --Re5_rgb: 209,64,62;
        --Re6_rgb: 217,97,95;
        --Re7_rgb: 225,130,129;
        --Re8_rgb: 233,163,162;
        --Re9_rgb: 241,197,196;
        --Re10_rgb: 249,229,229;
        --Or0_rgb: 40,24,15;
        --Or1_rgb: 48,27,16;
        --Or2_rgb: 74,35,14;
        --Or3_rgb: 120,54,16;
        --Or4_rgb: 169,73,13;
        --Or5_rgb: 214,96,17;
        --Or6_rgb: 221,124,58;
        --Or7_rgb: 228,151,100;
        --Or8_rgb: 235,179,141;
        --Or9_rgb: 242,206,182;
        --Or10_rgb: 250,234,223;
        --Ye0_rgb: 42,30,15;
        --Ye1_rgb: 52,36,16;
        --Ye2_rgb: 77,48,11;
        --Ye3_rgb: 124,76,8;
        --Ye4_rgb: 173,104,0;
        --Ye5_rgb: 219,135,0;
        --Ye6_rgb: 225,156,44;
        --Ye7_rgb: 231,177,88;
        --Ye8_rgb: 238,197,132;
        --Ye9_rgb: 244,218,177;
        --Ye10_rgb: 250,239,221;
        --Ly0_rgb: 42,35,16;
        --Ly1_rgb: 51,42,17;
        --Ly2_rgb: 73,57,12;
        --Ly3_rgb: 116,89,9;
        --Ly4_rgb: 162,124,0;
        --Ly5_rgb: 204,160,0;
        --Ly6_rgb: 213,176,44;
        --Ly7_rgb: 222,193,88;
        --Ly8_rgb: 231,209,132;
        --Ly9_rgb: 239,226,177;
        --Ly10_rgb: 248,242,221;
        --Lg0_rgb: 25,34,15;
        --Lg1_rgb: 30,41,17;
        --Lg2_rgb: 39,60,14;
        --Lg3_rgb: 60,96,15;
        --Lg4_rgb: 80,132,11;
        --Lg5_rgb: 103,167,14;
        --Lg6_rgb: 129,182,56;
        --Lg7_rgb: 156,197,98;
        --Lg8_rgb: 182,213,139;
        --Lg9_rgb: 208,228,181;
        --Lg10_rgb: 235,243,223;
        --Gr0_rgb: 16,32,23;
        --Gr1_rgb: 17,39,27;
        --Gr2_rgb: 18,57,35;
        --Gr3_rgb: 23,92,52;
        --Gr4_rgb: 25,128,66;
        --Gr5_rgb: 31,162,81;
        --Gr6_rgb: 70,178,111;
        --Gr7_rgb: 109,194,141;
        --Gr8_rgb: 147,210,171;
        --Gr9_rgb: 186,226,201;
        --Gr10_rgb: 225,243,232;
        --Cy0_rgb: 12,31,32;
        --Cy1_rgb: 13,38,39;
        --Cy2_rgb: 9,55,57;
        --Cy3_rgb: 8,91,92;
        --Cy4_rgb: 2,128,128;
        --Cy5_rgb: 3,162,159;
        --Cy6_rgb: 47,178,176;
        --Cy7_rgb: 90,194,192;
        --Cy8_rgb: 134,210,209;
        --Cy9_rgb: 178,226,225;
        --Cy10_rgb: 221,243,243;
        --Lb0_rgb: 10,27,35;
        --Lb1_rgb: 11,32,42;
        --Lb2_rgb: 8,45,64;
        --Lb3_rgb: 6,74,105;
        --Lb4_rgb: 0,105,150;
        --Lb5_rgb: 0,135,189;
        --Lb6_rgb: 44,156,200;
        --Lb7_rgb: 88,177,212;
        --Lb8_rgb: 132,197,223;
        --Lb9_rgb: 177,219,235;
        --Lb10_rgb: 221,239,246;
        --Bl0_rgb: 21,24,38;
        --Bl1_rgb: 24,28,47;
        --Bl2_rgb: 31,39,72;
        --Bl3_rgb: 46,60,118;
        --Bl4_rgb: 59,83,168;
        --Bl5_rgb: 75,107,212;
        --Bl6_rgb: 106,133,219;
        --Bl7_rgb: 137,158,227;
        --Bl8_rgb: 169,184,234;
        --Bl9_rgb: 200,210,242;
        --Bl10_rgb: 231,235,249;
        --Pu0_rgb: 29,22,40;
        --Pu1_rgb: 34,26,49;
        --Pu2_rgb: 49,33,76;
        --Pu3_rgb: 78,49,125;
        --Pu4_rgb: 109,63,177;
        --Pu5_rgb: 140,80,224;
        --Pu6_rgb: 160,110,229;
        --Pu7_rgb: 180,141,235;
        --Pu8_rgb: 200,171,240;
        --Pu9_rgb: 219,201,245;
        --Pu10_rgb: 240,232,251;
        --Br0_rgb: 33,29,27;
        --Br1_rgb: 40,35,32;
        --Br2_rgb: 56,47,42;
        --Br3_rgb: 89,72,63;
        --Br4_rgb: 122,97,84;
        --Br5_rgb: 154,124,106;
        --Br6_rgb: 172,147,132;
        --Br7_rgb: 189,169,158;
        --Br8_rgb: 206,191,183;
        --Br9_rgb: 224,215,209;
        --Br10_rgb: 242,238,235;
        --Si0_rgb: 33,35,37;
        --Si1_rgb: 39,41,44;
        --Si2_rgb: 54,57,63;
        --Si3_rgb: 83,89,98;
        --Si4_rgb: 111,121,135;
        --Si5_rgb: 140,153,170;
        --Si6_rgb: 160,171,185;
        --Si7_rgb: 180,188,199;
        --Si8_rgb: 200,206,214;
        --Si9_rgb: 220,224,229;
        --Si10_rgb: 240,242,244
    }
    `;

    // 浅色模式CSS变量
    const lightCSS = `
    :root {
        --Ga0: #F6F7F8;
        --Ga0_s: #F6F7F8;
        --Ga0_t: #F6F7F8;
        --Ga1: #F1F2F3;
        --Ga1_s: #F1F2F3;
        --Ga1_t: #F1F2F3;
        --Ga1_e: #F1F2F3;
        --Ga2: #E3E5E7;
        --Ga2_t: #E3E5E7;
        --Ga3: #C9CCD0;
        --Ga3_t: #C9CCD0;
        --Ga4: #AEB3B9;
        --Ga4_t: #AEB3B9;
        --Ga5: #9499A0;
        --Ga5_t: #9499A0;
        --Ga6: #797F87;
        --Ga6_t: #797F87;
        --Ga7: #61666D;
        --Ga7_t: #61666D;
        --Ga8: #484C53;
        --Ga8_t: #484C53;
        --Ga9: #2F3238;
        --Ga9_t: #2F3238;
        --Ga10: #18191C;
        --Ga10_t: #18191C;
        --Ga11: #FFFFFF;
        --Ga12: #F1F2F3;
        --Ga12_s: #F6F7F8;
        --Ga13: #F1F2F3;
        --Ga13_s: #F1F2F3;
        --Wh0: #FFFFFF;
        --Wh0_s: #FFFFFF;
        --Wh0_t: #FFFFFF;
        --Ba0: #000000;
        --Ba0_s: #000000;
        --Ba0_t: #000000;
        --Pi0: #FFF3F6;
        --Pi1: #FFECF1;
        --Pi2: #FFD9E4;
        --Pi3: #FFB3CA;
        --Pi4: #FF8CB0;
        --Pi5: #FF6699;
        --Pi5_t: #FF6699;
        --Pi6: #E84B85;
        --Pi7: #D03171;
        --Pi8: #AD1C5B;
        --Pi9: #771141;
        --Pi10: #3F0723;
        --Ma0: #FEF3FC;
        --Ma1: #FDEBFA;
        --Ma2: #FBD7F4;
        --Ma3: #F7AEEB;
        --Ma4: #F286E2;
        --Ma5: #EE5DDB;
        --Ma6: #DA41CB;
        --Ma7: #C525BA;
        --Ma8: #9B1797;
        --Ma9: #670F67;
        --Ma10: #330834;
        --Re0: #FEF3F2;
        --Re1: #FEECEA;
        --Re2: #FDD7D4;
        --Re3: #FCAFAA;
        --Re4: #FA857F;
        --Re5: #F85A54;
        --Re6: #E23D3D;
        --Re7: #C9272C;
        --Re8: #9F1922;
        --Re9: #710E18;
        --Re10: #3B060D;
        --Or0: #FFF6EE;
        --Or1: #FFF0E3;
        --Or2: #FFE1C7;
        --Or3: #FFC18F;
        --Or4: #FFA058;
        --Or5: #FF7F24;
        --Or6: #E95B03;
        --Or7: #BB4100;
        --Or8: #8D2D00;
        --Or9: #5E1B00;
        --Or10: #2F0C00;
        --Ye0: #FFFAEF;
        --Ye1: #FFF6E4;
        --Ye2: #FFEEC9;
        --Ye3: #FFDB93;
        --Ye4: #FFC65D;
        --Ye5: #FFB027;
        --Ye6: #FA9600;
        --Ye7: #C26E00;
        --Ye8: #8A4A00;
        --Ye9: #5B2E00;
        --Ye10: #2F1600;
        --Ly0: #FFFCEC;
        --Ly1: #FFFADF;
        --Ly2: #FFF5BF;
        --Ly3: #FFEA80;
        --Ly4: #FFDC40;
        --Ly5: #FFCC00;
        --Ly6: #D5A300;
        --Ly7: #AA7D00;
        --Ly8: #805A00;
        --Ly9: #553900;
        --Ly10: #2B1B00;
        --Lg0: #F7FBEF;
        --Lg1: #F2F9E4;
        --Lg2: #E3F2C8;
        --Lg3: #C7E691;
        --Lg4: #A9D95B;
        --Lg5: #88CC24;
        --Lg6: #66B105;
        --Lg7: #4E8E04;
        --Lg8: #376A03;
        --Lg9: #224702;
        --Lg10: #102301;
        --Gr0: #EFFBF3;
        --Gr1: #E4F8EA;
        --Gr2: #CAF1D6;
        --Gr3: #95E4AF;
        --Gr4: #5FD689;
        --Gr5: #2AC864;
        --Gr6: #0EB350;
        --Gr7: #089043;
        --Gr8: #046E35;
        --Gr9: #034926;
        --Gr10: #012414;
        --Cy0: #EDFBFB;
        --Cy1: #E2F8F8;
        --Cy2: #C4EFF0;
        --Cy3: #89E1E1;
        --Cy4: #4FD3D1;
        --Cy5: #14C4BF;
        --Cy6: #02AAAA;
        --Cy7: #018488;
        --Cy8: #015F66;
        --Cy9: #013D44;
        --Cy10: #001D22;
        --Lb0: #ECFAFE;
        --Lb1: #DFF6FD;
        --Lb2: #BFEDFA;
        --Lb3: #80DAF6;
        --Lb4: #40C5F1;
        --Lb5: #00AEEC;
        --Lb6: #008AC5;
        --Lb7: #00699D;
        --Lb8: #004B76;
        --Lb9: #002F4F;
        --Lb10: #001627;
        --Bl0: #F3F5FF;
        --Bl1: #EBEFFF;
        --Bl2: #D7DFFF;
        --Bl3: #B0C1FF;
        --Bl4: #88A4FF;
        --Bl5: #6188FF;
        --Bl6: #4C6DE4;
        --Bl7: #3752C8;
        --Bl8: #2136AC;
        --Bl9: #121F7F;
        --Bl10: #080D41;
        --Pu0: #F9F4FF;
        --Pu1: #F6EDFF;
        --Pu2: #EDDBFF;
        --Pu3: #D8B6FF;
        --Pu4: #C392FF;
        --Pu5: #AC6DFF;
        --Pu6: #8F56E4;
        --Pu7: #723ECC;
        --Pu8: #5627B3;
        --Pu9: #371683;
        --Pu10: #190A44;
        --Br0: #FAF8F6;
        --Br1: #F7F3F0;
        --Br2: #EFE7E0;
        --Br3: #E0CFC1;
        --Br4: #D0B7A3;
        --Br5: #C19D84;
        --Br6: #A5816A;
        --Br7: #856553;
        --Br8: #634A3E;
        --Br9: #423029;
        --Br10: #211815;
        --Si0: #F9FBFC;
        --Si1: #F5F7FA;
        --Si2: #EBEFF4;
        --Si3: #D7E0EA;
        --Si4: #C3D0DF;
        --Si5: #AFC0D5;
        --Si6: #8D9FB9;
        --Si7: #6D7F9C;
        --Si8: #4D5D7C;
        --Si9: #323D54;
        --Si10: #191E2B;
        --Ga0_rgb: 246,247,248;
        --Ga0_s_rgb: 246,247,248;
        --Ga0_t_rgb: 246,247,248;
        --Ga1_rgb: 241,242,243;
        --Ga1_s_rgb: 241,242,243;
        --Ga1_t_rgb: 241,242,243;
        --Ga1_e_rgb: 241,242,243;
        --Ga2_rgb: 227,229,231;
        --Ga2_t_rgb: 227,229,231;
        --Ga3_rgb: 201,204,208;
        --Ga3_t_rgb: 201,204,208;
        --Ga4_rgb: 174,179,185;
        --Ga4_t_rgb: 174,179,185;
        --Ga5_rgb: 148,153,160;
        --Ga5_t_rgb: 148,153,160;
        --Ga6_rgb: 121,127,135;
        --Ga6_t_rgb: 121,127,135;
        --Ga7_rgb: 97,102,109;
        --Ga7_t_rgb: 97,102,109;
        --Ga8_rgb: 72,76,83;
        --Ga8_t_rgb: 72,76,83;
        --Ga9_rgb: 47,50,56;
        --Ga9_t_rgb: 47,50,56;
        --Ga10_rgb: 24,25,28;
        --Ga10_t_rgb: 24,25,28;
        --Ga11_rgb: 255,255,255;
        --Ga12_rgb: 241,242,243;
        --Ga12_s_rgb: 246,247,248;
        --Ga13_rgb: 241,242,243;
        --Ga13_s_rgb: 241,242,243;
        --Wh0_rgb: 255,255,255;
        --Wh0_s_rgb: 255,255,255;
        --Wh0_t_rgb: 255,255,255;
        --Ba0_rgb: 0,0,0;
        --Ba0_s_rgb: 0,0,0;
        --Ba0_t_rgb: 0,0,0;
        --Pi0_rgb: 255,243,246;
        --Pi1_rgb: 255,236,241;
        --Pi2_rgb: 255,217,228;
        --Pi3_rgb: 255,179,202;
        --Pi4_rgb: 255,140,176;
        --Pi5_rgb: 255,102,153;
        --Pi5_t_rgb: 255,102,153;
        --Pi6_rgb: 232,75,133;
        --Pi7_rgb: 208,49,113;
        --Pi8_rgb: 173,28,91;
        --Pi9_rgb: 119,17,65;
        --Pi10_rgb: 63,7,35;
        --Ma0_rgb: 254,243,252;
        --Ma1_rgb: 253,235,250;
        --Ma2_rgb: 251,215,244;
        --Ma3_rgb: 247,174,235;
        --Ma4_rgb: 242,134,226;
        --Ma5_rgb: 238,93,219;
        --Ma6_rgb: 218,65,203;
        --Ma7_rgb: 197,37,186;
        --Ma8_rgb: 155,23,151;
        --Ma9_rgb: 103,15,103;
        --Ma10_rgb: 51,8,52;
        --Re0_rgb: 254,243,242;
        --Re1_rgb: 254,236,234;
        --Re2_rgb: 253,215,212;
        --Re3_rgb: 252,175,170;
        --Re4_rgb: 250,133,127;
        --Re5_rgb: 248,90,84;
        --Re6_rgb: 226,61,61;
        --Re7_rgb: 201,39,44;
        --Re8_rgb: 159,25,34;
        --Re9_rgb: 113,14,24;
        --Re10_rgb: 59,6,13;
        --Or0_rgb: 255,246,238;
        --Or1_rgb: 255,240,227;
        --Or2_rgb: 255,225,199;
        --Or3_rgb: 255,193,143;
        --Or4_rgb: 255,160,88;
        --Or5_rgb: 255,127,36;
        --Or6_rgb: 233,91,3;
        --Or7_rgb: 187,65,0;
        --Or8_rgb: 141,45,0;
        --Or9_rgb: 94,27,0;
        --Or10_rgb: 47,12,0;
        --Ye0_rgb: 255,250,239;
        --Ye1_rgb: 255,246,228;
        --Ye2_rgb: 255,238,201;
        --Ye3_rgb: 255,219,147;
        --Ye4_rgb: 255,198,93;
        --Ye5_rgb: 255,176,39;
        --Ye6_rgb: 250,150,0;
        --Ye7_rgb: 194,110,0;
        --Ye8_rgb: 138,74,0;
        --Ye9_rgb: 91,46,0;
        --Ye10_rgb: 47,22,0;
        --Ly0_rgb: 255,252,236;
        --Ly1_rgb: 255,250,223;
        --Ly2_rgb: 255,245,191;
        --Ly3_rgb: 255,234,128;
        --Ly4_rgb: 255,220,64;
        --Ly5_rgb: 255,204,0;
        --Ly6_rgb: 213,163,0;
        --Ly7_rgb: 170,125,0;
        --Ly8_rgb: 128,90,0;
        --Ly9_rgb: 85,57,0;
        --Ly10_rgb: 43,27,0;
        --Lg0_rgb: 247,251,239;
        --Lg1_rgb: 242,249,228;
        --Lg2_rgb: 227,242,200;
        --Lg3_rgb: 199,230,145;
        --Lg4_rgb: 169,217,91;
        --Lg5_rgb: 136,204,36;
        --Lg6_rgb: 102,177,5;
        --Lg7_rgb: 78,142,4;
        --Lg8_rgb: 55,106,3;
        --Lg9_rgb: 34,71,2;
        --Lg10_rgb: 16,35,1;
        --Gr0_rgb: 239,251,243;
        --Gr1_rgb: 228,248,234;
        --Gr2_rgb: 202,241,214;
        --Gr3_rgb: 149,228,175;
        --Gr4_rgb: 95,214,137;
        --Gr5_rgb: 42,200,100;
        --Gr6_rgb: 14,179,80;
        --Gr7_rgb: 8,144,67;
        --Gr8_rgb: 4,110,53;
        --Gr9_rgb: 3,73,38;
        --Gr10_rgb: 1,36,20;
        --Cy0_rgb: 237,251,251;
        --Cy1_rgb: 226,248,248;
        --Cy2_rgb: 196,239,240;
        --Cy3_rgb: 137,225,225;
        --Cy4_rgb: 79,211,209;
        --Cy5_rgb: 20,196,191;
        --Cy6_rgb: 2,170,170;
        --Cy7_rgb: 1,132,136;
        --Cy8_rgb: 1,95,102;
        --Cy9_rgb: 1,61,68;
        --Cy10_rgb: 0,29,34;
        --Lb0_rgb: 236,250,254;
        --Lb1_rgb: 223,246,253;
        --Lb2_rgb: 191,237,250;
        --Lb3_rgb: 128,218,246;
        --Lb4_rgb: 64,197,241;
        --Lb5_rgb: 0,174,236;
        --Lb6_rgb: 0,138,197;
        --Lb7_rgb: 0,105,157;
        --Lb8_rgb: 0,75,118;
        --Lb9_rgb: 0,47,79;
        --Lb10_rgb: 0,22,39;
        --Bl0_rgb: 243,245,255;
        --Bl1_rgb: 235,239,255;
        --Bl2_rgb: 215,223,255;
        --Bl3_rgb: 176,193,255;
        --Bl4_rgb: 136,164,255;
        --Bl5_rgb: 97,136,255;
        --Bl6_rgb: 76,109,228;
        --Bl7_rgb: 55,82,200;
        --Bl8_rgb: 33,54,172;
        --Bl9_rgb: 18,31,127;
        --Bl10_rgb: 8,13,65;
        --Pu0_rgb: 249,244,255;
        --Pu1_rgb: 246,237,255;
        --Pu2_rgb: 237,219,255;
        --Pu3_rgb: 216,182,255;
        --Pu4_rgb: 195,146,255;
        --Pu5_rgb: 172,109,255;
        --Pu6_rgb: 143,86,228;
        --Pu7_rgb: 114,62,204;
        --Pu8_rgb: 86,39,179;
        --Pu9_rgb: 55,22,131;
        --Pu10_rgb: 25,10,68;
        --Br0_rgb: 250,248,246;
        --Br1_rgb: 247,243,240;
        --Br2_rgb: 239,231,224;
        --Br3_rgb: 224,207,193;
        --Br4_rgb: 208,183,163;
        --Br5_rgb: 193,157,132;
        --Br6_rgb: 165,129,106;
        --Br7_rgb: 133,101,83;
        --Br8_rgb: 99,74,62;
        --Br9_rgb: 66,48,41;
        --Br10_rgb: 33,24,21;
        --Si0_rgb: 249,251,252;
        --Si1_rgb: 245,247,250;
        --Si2_rgb: 235,239,244;
        --Si3_rgb: 215,224,234;
        --Si4_rgb: 195,208,223;
        --Si5_rgb: 175,192,213;
        --Si6_rgb: 141,159,185;
        --Si7_rgb: 109,127,156;
        --Si8_rgb: 77,93,124;
        --Si9_rgb: 50,61,84;
        --Si10_rgb: 25,30,43
    }
    `;

    // 创建样式元素
    let styleElement = document.createElement('style');
    styleElement.id = 'bilibili-auto-theme';
    document.head.appendChild(styleElement);

    // 检测系统主题变化
    function updateTheme() {
        const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (isDarkMode) {
            styleElement.textContent = darkCSS;
            // 同时设置B站的主题属性
            document.documentElement.setAttribute('data-theme', 'dark');
        } else {
            styleElement.textContent = lightCSS;
            document.documentElement.setAttribute('data-theme', 'light');
        }
    }

    // 初始设置
    updateTheme();

    // 监听系统主题变化
    window.matchMedia('(prefers-color-scheme: dark)').addListener(updateTheme);

    // 监听页面主题切换（防止与B站自带主题切换冲突）
    const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
            if (mutation.type === 'attributes' && mutation.attributeName === 'data-theme') {
                // 如果用户手动切换了主题，暂时禁用自动切换
                observer.disconnect();
                setTimeout(() => {
                    observer.observe(document.documentElement, {
                        attributes: true,
                        attributeFilter: ['data-theme']
                    });
                }, 1000);
            }
        });
    });

    // 开始观察
    observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['data-theme']
    });

    console.log('B站自动主题切换脚本已启用');
})();